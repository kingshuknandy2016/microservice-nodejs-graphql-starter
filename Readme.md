<html><center><h1>TypeScript Express Microservice Template</h1></center></html>

![NodeJS](https://img.shields.io/badge/node.js-6DA55F?style=for-the-badge&logo=node.js&logoColor=white)
![Express.js](https://img.shields.io/badge/express.js-%23404d59.svg?style=for-the-badge&logo=express&logoColor=%2361DAFB)
![Postgres](https://img.shields.io/badge/postgres-%23316192.svg?style=for-the-badge&logo=postgresql&logoColor=white)
![Sequelize](https://img.shields.io/badge/Sequelize-52B0E7?style=for-the-badge&logo=Sequelize&logoColor=white)
![Swagger](https://img.shields.io/badge/-Swagger-%23Clojure?style=for-the-badge&logo=swagger&logoColor=white)
![Apollo-GraphQL](https://img.shields.io/badge/-ApolloGraphQL-311C87?style=for-the-badge&logo=apollo-graphql)
![GraphQL](https://img.shields.io/badge/-GraphQL-E10098?style=for-the-badge&logo=graphql&logoColor=white)
![JWT](https://img.shields.io/badge/JWT-black?style=for-the-badge&logo=JSON%20web%20tokens)
![Jest](https://img.shields.io/badge/-jest-%23C21325?style=for-the-badge&logo=jest&logoColor=white)
![Docker](https://img.shields.io/badge/docker-%230db7ed.svg?style=for-the-badge&logo=docker&logoColor=white)

![Microservices-Built-With-Node-1](https://github.com/kingshuknandy2016/microservice-nodejs-starter/assets/36564770/28454ace-8629-4849-8da1-38bab6076e26)

## Quick Start

Get the application DB up first, using Postgres Docker Image

```cmd
docker pull postgres
```

```cmd
docker run --name postgres-db -p 5432:5432 -e POSTGRES_PASSWORD=password -d postgres
```
Then execute the following command start the application in dev mode

```cmd
npm run start:dev
```
### Usage
- **Application Health** http://localhost:3000/health
- **Graphql Server** 
  - http://localhost:3000/graphql or 
  - https://studio.apollographql.com/sandbox/explorer?endpoint=http://localhost:3000/graphql
- **Swagger** http://localhost:3000/api-docs/

In order to access the private the routes, we need to pass the JWT token generated by the login API

## Features

- Authentication using JWT
- Password Encryption using bcrypt
- Unit testing using jest
- Swagger to interact with the APIs
- Integrated with ***PostgreSQL*** Database
- Sequelize as ORM used here
- Apollo Server 4 is integrated here. So **Graphql** is here
- Deployment Using Docker and Docker Compose

## Testing

- Execute the ***unit test*** cases using the command
```cmd
npm test
```

## Containerization and Deployment

### Simple Implementation deploying docker images

In order to communicate between containers we need to create a [user-defined custom bridge networks](https://docs.docker.com/network/drivers/bridge/)
```cmd
  docker network create -o com.docker.network.bridge.enable_icc=true custom-network
```
Then, Get the Postgres DB up. Run the postgres image, passing the newly created network ***custom-network***
```cmd
docker run --network custom-network --name postgres-db -p 5432:5432 -e POSTGRES_PASSWORD=password postgres
```
Then, build the app's image
```cmd
docker build . -t kingshuknandy/node-microservice
```
Finally, run the app's image, passing the newly created network ***custom-network*** 
```cmd
docker run -p 3000:3000 --network custom-network --env-file .env  --env DB_HOST='postgres-db' --name node-microservice kingshuknandy/node-microservice:latest
```
### Using Docker Hub

- Created the [Dockerfile](/Dockerfile) to build the app
- Defined the services that make up the app in [docker-compose.yml](/docker-compose.yml) so they can be run together in an isolated environment.
- Run ***docker-compose up*** and Compose starts and runs your entire app.
```cmd
docker-compose up
```

## List of Routes

```sh
# Public API Routes:
+--------+------------------------------+
  Method | URI
+--------+------------------------------+
  GET    | /health
  POST   | /apis/v1/auth/signUp
  POST   | /apis/v1/auth/login
  GET    | /apis/v1/employees/getEmployeeBasic
  GET    | /apis/v1/employees/getEmployees
  POST   | /apis/v1/employees/setEmployee
+--------+------------------------------+

# Private API Routes:
+--------+------------------------------+
  Method | URI
+--------+------------------------------+
  GET    | /apis/v1/users/getUsersBasic
  GET    | /apis/v1/users/getUsers
  POST   | /apis/v1/users/setUser
+--------+------------------------------+
```





## References